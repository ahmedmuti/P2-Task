import{H as A,Ia as h,a as p,b as u,e as s,f as n,g as E,k as o,q as l,t as m}from"./chunk-NIPSTPOT.js";var B=(i=>(i.MALE="male",i.FEMALE="female",i.OTHER="other",i))(B||{});var C=class g{constructor(r){this.authService=r}MOCK_BENEFICIARIES=[{id:"1",name:"John Doe",age:28,gender:"male",email:"john@example.com",phone:"+1234567890",budget:5e3,power:85,isApproved:!0,ratings:[{id:"101",raterId:"2",raterName:"Jane Smith",value:4.5,comment:"Great to work with!",createdAt:new Date("2023-01-15")}],averageRating:4.5,createdAt:new Date("2022-12-01"),updatedAt:new Date("2023-01-15")},{id:"2",name:"Jane Smith",age:32,gender:"female",email:"jane@example.com",phone:"+1987654321",budget:7500,power:92,isApproved:!0,ratings:[{id:"102",raterId:"1",raterName:"John Doe",value:5,comment:"Excellent communication and results",createdAt:new Date("2023-02-10")}],averageRating:5,createdAt:new Date("2022-11-15"),updatedAt:new Date("2023-02-10")},{id:"3",name:"Alex Johnson",age:25,gender:"other",email:"alex@example.com",phone:"+1122334455",budget:3200,power:78,isApproved:!0,ratings:[],averageRating:0,createdAt:new Date("2023-03-01"),updatedAt:new Date("2023-03-01")},{id:"4",name:"Sarah Williams",age:30,gender:"female",email:"sarah@example.com",phone:"+1555666777",budget:6e3,power:88,isApproved:!1,ratings:[],averageRating:0,createdAt:new Date("2023-04-05"),updatedAt:new Date("2023-04-05")}];beneficiaries=A([...this.MOCK_BENEFICIARIES]);getAllBeneficiaries(){return s([...this.MOCK_BENEFICIARIES]).pipe(o(500))}getApprovedBeneficiaries(){return console.log("getApprovedBeneficiaries() called - returning mock data"),s(this.MOCK_BENEFICIARIES.filter(r=>r.isApproved)).pipe(o(1e3))}getBeneficiaryById(r){let e=this.MOCK_BENEFICIARIES.find(i=>i.id===r);return e?s(p({},e)).pipe(o(300)):n(()=>new Error("Beneficiary not found"))}addBeneficiary(r){if(!this.authService.isAdmin())return n(()=>new Error("Unauthorized: Only admins can add beneficiaries"));let e=u(p({},r),{id:(this.MOCK_BENEFICIARIES.length+1).toString(),ratings:[],averageRating:0,createdAt:new Date,updatedAt:new Date});return this.MOCK_BENEFICIARIES.push(e),this.beneficiaries.set([...this.MOCK_BENEFICIARIES]),s(e).pipe(o(500))}approveBeneficiary(r){if(!this.authService.isAdmin())return n(()=>new Error("Unauthorized: Only admins can approve beneficiaries"));let e=this.MOCK_BENEFICIARIES.findIndex(i=>i.id===r);return e===-1?n(()=>new Error("Beneficiary not found")):(this.MOCK_BENEFICIARIES[e]=u(p({},this.MOCK_BENEFICIARIES[e]),{isApproved:!0,updatedAt:new Date}),this.beneficiaries.set([...this.MOCK_BENEFICIARIES]),s(this.MOCK_BENEFICIARIES[e]).pipe(o(500)))}rateBeneficiary(r,e,i){if(!this.authService.isAuthenticated())return n(()=>new Error("Unauthorized: Please login to rate beneficiaries"));let a=this.authService.currentUser();if(!a)return n(()=>new Error("User not found"));if(a.id===r)return n(()=>new Error("You cannot rate yourself"));let t=this.MOCK_BENEFICIARIES.findIndex(d=>d.id===r);if(t===-1)return n(()=>new Error("Beneficiary not found"));let f=this.MOCK_BENEFICIARIES[t].ratings.findIndex(d=>d.raterId===a.id),I={id:Date.now().toString(),raterId:a.id,raterName:a.name,value:e,comment:i,createdAt:new Date},c;f>=0?(c=[...this.MOCK_BENEFICIARIES[t].ratings],c[f]=I):c=[...this.MOCK_BENEFICIARIES[t].ratings,I];let b=c.length>0?c.reduce((d,v)=>d+v.value,0)/c.length:0;return this.MOCK_BENEFICIARIES[t]=u(p({},this.MOCK_BENEFICIARIES[t]),{ratings:c,averageRating:b,updatedAt:new Date}),this.beneficiaries.set([...this.MOCK_BENEFICIARIES]),s(this.MOCK_BENEFICIARIES[t]).pipe(o(500))}searchBeneficiaries(r){if(!r.trim())return this.getAllBeneficiaries();let e=r.toLowerCase().trim();return s(this.MOCK_BENEFICIARIES.filter(i=>i.name.toLowerCase().includes(e)||i.email.toLowerCase().includes(e))).pipe(o(300))}sortBeneficiariesByName(r=!0){return this.getAllBeneficiaries().pipe(E(e=>[...e].sort((i,a)=>{let t=i.name.localeCompare(a.name);return r?t:-t})))}sortBeneficiariesByBudget(r=!0){return this.getAllBeneficiaries().pipe(E(e=>[...e].sort((i,a)=>{let t=i.budget-a.budget;return r?t:-t})))}sortBeneficiariesByPower(r=!0){return this.getAllBeneficiaries().pipe(E(e=>[...e].sort((i,a)=>{let t=i.power-a.power;return r?t:-t})))}static \u0275fac=function(e){return new(e||g)(m(h))};static \u0275prov=l({token:g,factory:g.\u0275fac,providedIn:"root"})};export{B as a,C as b};
